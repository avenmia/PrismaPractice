{"code":"import Observable from 'zen-observable-ts';\r\nimport { invariant, InvariantError } from 'ts-invariant';\r\nimport { validateOperation, isTerminating, LinkError, transformOperation, createOperation, } from './linkUtils';\r\nfunction passthrough(op, forward) {\r\n    return forward ? forward(op) : Observable.of();\r\n}\r\nfunction toLink(handler) {\r\n    return typeof handler === 'function' ? new ApolloLink(handler) : handler;\r\n}\r\nexport function empty() {\r\n    return new ApolloLink(function () { return Observable.of(); });\r\n}\r\nexport function from(links) {\r\n    if (links.length === 0)\r\n        return empty();\r\n    return links.map(toLink).reduce(function (x, y) { return x.concat(y); });\r\n}\r\nexport function split(test, left, right) {\r\n    var leftLink = toLink(left);\r\n    var rightLink = toLink(right || new ApolloLink(passthrough));\r\n    if (isTerminating(leftLink) && isTerminating(rightLink)) {\r\n        return new ApolloLink(function (operation) {\r\n            return test(operation)\r\n                ? leftLink.request(operation) || Observable.of()\r\n                : rightLink.request(operation) || Observable.of();\r\n        });\r\n    }\r\n    else {\r\n        return new ApolloLink(function (operation, forward) {\r\n            return test(operation)\r\n                ? leftLink.request(operation, forward) || Observable.of()\r\n                : rightLink.request(operation, forward) || Observable.of();\r\n        });\r\n    }\r\n}\r\nexport var concat = function (first, second) {\r\n    var firstLink = toLink(first);\r\n    if (isTerminating(firstLink)) {\r\n        invariant.warn(new LinkError(\"You are calling concat on a terminating link, which will have no effect\", firstLink));\r\n        return firstLink;\r\n    }\r\n    var nextLink = toLink(second);\r\n    if (isTerminating(nextLink)) {\r\n        return new ApolloLink(function (operation) {\r\n            return firstLink.request(operation, function (op) { return nextLink.request(op) || Observable.of(); }) || Observable.of();\r\n        });\r\n    }\r\n    else {\r\n        return new ApolloLink(function (operation, forward) {\r\n            return (firstLink.request(operation, function (op) {\r\n                return nextLink.request(op, forward) || Observable.of();\r\n            }) || Observable.of());\r\n        });\r\n    }\r\n};\r\nvar ApolloLink = (function () {\r\n    function ApolloLink(request) {\r\n        if (request)\r\n            this.request = request;\r\n    }\r\n    ApolloLink.prototype.split = function (test, left, right) {\r\n        return this.concat(split(test, left, right || new ApolloLink(passthrough)));\r\n    };\r\n    ApolloLink.prototype.concat = function (next) {\r\n        return concat(this, next);\r\n    };\r\n    ApolloLink.prototype.request = function (operation, forward) {\r\n        throw new InvariantError('request is not implemented');\r\n    };\r\n    ApolloLink.empty = empty;\r\n    ApolloLink.from = from;\r\n    ApolloLink.split = split;\r\n    ApolloLink.execute = execute;\r\n    return ApolloLink;\r\n}());\r\nexport { ApolloLink };\r\nexport function execute(link, operation) {\r\n    return (link.request(createOperation(operation.context, transformOperation(validateOperation(operation)))) || Observable.of());\r\n}\r\n//# sourceMappingURL=link.js.map","map":"{\"version\":3,\"file\":\"link.js\",\"sourceRoot\":\"\",\"sources\":[\"../../src/link.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,UAAU,MAAM,mBAAmB,CAAC;AAC3C,OAAO,EAAE,SAAS,EAAE,cAAc,EAAE,MAAM,cAAc,CAAC;AAUzD,OAAO,EACL,iBAAiB,EACjB,aAAa,EACb,SAAS,EACT,kBAAkB,EAClB,eAAe,GAChB,MAAM,aAAa,CAAC;AAErB,SAAS,WAAW,CAAC,EAAE,EAAE,OAAO;IAC9B,OAAO,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,EAAE,CAAC;AACjD,CAAC;AAED,SAAS,MAAM,CAAC,OAAoC;IAClD,OAAO,OAAO,OAAO,KAAK,UAAU,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;AAC3E,CAAC;AAED,MAAM,UAAU,KAAK;IACnB,OAAO,IAAI,UAAU,CAAC,cAAM,OAAA,UAAU,CAAC,EAAE,EAAE,EAAf,CAAe,CAAC,CAAC;AAC/C,CAAC;AAED,MAAM,UAAU,IAAI,CAAC,KAAmB;IACtC,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC;QAAE,OAAO,KAAK,EAAE,CAAC;IACvC,OAAO,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,OAAA,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAX,CAAW,CAAC,CAAC;AACzD,CAAC;AAED,MAAM,UAAU,KAAK,CACnB,IAAgC,EAChC,IAAiC,EACjC,KAAmC;IAEnC,IAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;IAC9B,IAAM,SAAS,GAAG,MAAM,CAAC,KAAK,IAAI,IAAI,UAAU,CAAC,WAAW,CAAC,CAAC,CAAC;IAE/D,IAAI,aAAa,CAAC,QAAQ,CAAC,IAAI,aAAa,CAAC,SAAS,CAAC,EAAE;QACvD,OAAO,IAAI,UAAU,CAAC,UAAA,SAAS;YAC7B,OAAO,IAAI,CAAC,SAAS,CAAC;gBACpB,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,UAAU,CAAC,EAAE,EAAE;gBAChD,CAAC,CAAC,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,UAAU,CAAC,EAAE,EAAE,CAAC;QACtD,CAAC,CAAC,CAAC;KACJ;SAAM;QACL,OAAO,IAAI,UAAU,CAAC,UAAC,SAAS,EAAE,OAAO;YACvC,OAAO,IAAI,CAAC,SAAS,CAAC;gBACpB,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,EAAE,OAAO,CAAC,IAAI,UAAU,CAAC,EAAE,EAAE;gBACzD,CAAC,CAAC,SAAS,CAAC,OAAO,CAAC,SAAS,EAAE,OAAO,CAAC,IAAI,UAAU,CAAC,EAAE,EAAE,CAAC;QAC/D,CAAC,CAAC,CAAC;KACJ;AACH,CAAC;AAGD,MAAM,CAAC,IAAM,MAAM,GAAG,UACpB,KAAkC,EAClC,MAAmC;IAEnC,IAAM,SAAS,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;IAChC,IAAI,aAAa,CAAC,SAAS,CAAC,EAAE;QAC5B,SAAS,CAAC,IAAI,CACZ,IAAI,SAAS,CACX,yEAAyE,EACzE,SAAS,CACV,CACF,CAAC;QACF,OAAO,SAAS,CAAC;KAClB;IACD,IAAM,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;IAEhC,IAAI,aAAa,CAAC,QAAQ,CAAC,EAAE;QAC3B,OAAO,IAAI,UAAU,CACnB,UAAA,SAAS;YACP,OAAA,SAAS,CAAC,OAAO,CACf,SAAS,EACT,UAAA,EAAE,IAAI,OAAA,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,UAAU,CAAC,EAAE,EAAE,EAAvC,CAAuC,CAC9C,IAAI,UAAU,CAAC,EAAE,EAAE;QAHpB,CAGoB,CACvB,CAAC;KACH;SAAM;QACL,OAAO,IAAI,UAAU,CAAC,UAAC,SAAS,EAAE,OAAO;YACvC,OAAO,CACL,SAAS,CAAC,OAAO,CAAC,SAAS,EAAE,UAAA,EAAE;gBAC7B,OAAO,QAAQ,CAAC,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,IAAI,UAAU,CAAC,EAAE,EAAE,CAAC;YAC1D,CAAC,CAAC,IAAI,UAAU,CAAC,EAAE,EAAE,CACtB,CAAC;QACJ,CAAC,CAAC,CAAC;KACJ;AACH,CAAC,CAAC;AAEF;IAME,oBAAY,OAAwB;QAClC,IAAI,OAAO;YAAE,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;IACtC,CAAC;IAEM,0BAAK,GAAZ,UACE,IAAgC,EAChC,IAAiC,EACjC,KAAmC;QAEnC,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,IAAI,IAAI,UAAU,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;IAC9E,CAAC;IAEM,2BAAM,GAAb,UAAc,IAAiC;QAC7C,OAAO,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAC5B,CAAC;IAEM,4BAAO,GAAd,UACE,SAAoB,EACpB,OAAkB;QAElB,MAAM,IAAI,cAAc,CAAC,4BAA4B,CAAC,CAAC;IACzD,CAAC;IA1Ba,gBAAK,GAAG,KAAK,CAAC;IACd,eAAI,GAAG,IAAI,CAAC;IACZ,gBAAK,GAAG,KAAK,CAAC;IACd,kBAAO,GAAG,OAAO,CAAC;IAwBlC,iBAAC;CAAA,AA5BD,IA4BC;SA5BY,UAAU;AA8BvB,MAAM,UAAU,OAAO,CACrB,IAAgB,EAChB,SAAyB;IAEzB,OAAO,CACL,IAAI,CAAC,OAAO,CACV,eAAe,CACb,SAAS,CAAC,OAAO,EACjB,kBAAkB,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC,CACjD,CACF,IAAI,UAAU,CAAC,EAAE,EAAE,CACrB,CAAC;AACJ,CAAC\"}","dtsmap":{"name":"/Users/ben/dev/apollo-link/packages/apollo-link/link.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"link.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"src/link.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,UAAU,MAAM,mBAAmB,CAAC;AAG3C,OAAO,EACL,cAAc,EACd,QAAQ,EACR,SAAS,EACT,cAAc,EACd,WAAW,EACZ,MAAM,SAAS,CAAC;AAkBjB,wBAAgB,KAAK,IAAI,UAAU,CAElC;AAED,wBAAgB,IAAI,CAAC,KAAK,EAAE,UAAU,EAAE,GAAG,UAAU,CAGpD;AAED,wBAAgB,KAAK,CACnB,IAAI,EAAE,CAAC,EAAE,EAAE,SAAS,KAAK,OAAO,EAChC,IAAI,EAAE,UAAU,GAAG,cAAc,EACjC,KAAK,CAAC,EAAE,UAAU,GAAG,cAAc,GAClC,UAAU,CAiBZ;AAGD,eAAO,MAAM,MAAM,yFAiClB,CAAC;AAEF,qBAAa,UAAU;IACrB,OAAc,KAAK,eAAS;IAC5B,OAAc,IAAI,cAAQ;IAC1B,OAAc,KAAK,eAAS;IAC5B,OAAc,OAAO,iBAAW;gBAEpB,OAAO,CAAC,EAAE,cAAc;IAI7B,KAAK,CACV,IAAI,EAAE,CAAC,EAAE,EAAE,SAAS,KAAK,OAAO,EAChC,IAAI,EAAE,UAAU,GAAG,cAAc,EACjC,KAAK,CAAC,EAAE,UAAU,GAAG,cAAc,GAClC,UAAU;IAIN,MAAM,CAAC,IAAI,EAAE,UAAU,GAAG,cAAc,GAAG,UAAU;IAIrD,OAAO,CACZ,SAAS,EAAE,SAAS,EACpB,OAAO,CAAC,EAAE,QAAQ,GACjB,UAAU,CAAC,WAAW,CAAC,GAAG,IAAI;CAGlC;AAED,wBAAgB,OAAO,CACrB,IAAI,EAAE,UAAU,EAChB,SAAS,EAAE,cAAc,GACxB,UAAU,CAAC,WAAW,CAAC,CASzB\"}"},"dts":{"name":"/Users/ben/dev/apollo-link/packages/apollo-link/link.d.ts","writeByteOrderMark":false,"text":"import Observable from 'zen-observable-ts';\r\nimport { GraphQLRequest, NextLink, Operation, RequestHandler, FetchResult } from './types';\r\nexport declare function empty(): ApolloLink;\r\nexport declare function from(links: ApolloLink[]): ApolloLink;\r\nexport declare function split(test: (op: Operation) => boolean, left: ApolloLink | RequestHandler, right?: ApolloLink | RequestHandler): ApolloLink;\r\nexport declare const concat: (first: RequestHandler | ApolloLink, second: RequestHandler | ApolloLink) => ApolloLink;\r\nexport declare class ApolloLink {\r\n    static empty: typeof empty;\r\n    static from: typeof from;\r\n    static split: typeof split;\r\n    static execute: typeof execute;\r\n    constructor(request?: RequestHandler);\r\n    split(test: (op: Operation) => boolean, left: ApolloLink | RequestHandler, right?: ApolloLink | RequestHandler): ApolloLink;\r\n    concat(next: ApolloLink | RequestHandler): ApolloLink;\r\n    request(operation: Operation, forward?: NextLink): Observable<FetchResult> | null;\r\n}\r\nexport declare function execute(link: ApolloLink, operation: GraphQLRequest): Observable<FetchResult>;\r\n//# sourceMappingURL=link.d.ts.map"}}
